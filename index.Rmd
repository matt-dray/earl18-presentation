---
title: "Crosstalk #EARL18"
subtitle: "Shiny-like without Shiny"
author: "Matt Dray | Dept for Education | EARL 2018"
output:
  xaringan::moon_reader:
    css: ["style/style.css", "style/style-fonts.css"]
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

class: center, middle, inverse

# Crosstalk `r icon::fa("comments")`

### Shiny-like without Shiny

.image-30[![](img/earl_logo_light.png)]

### Matt Dray | Dept for Education | #EARL2018

---
class: center, middle

# TL;DR&ast;

Need to create a small interactive app without a server or Shiny?

Try the [`crosstalk`](http://rstudio.github.io/crosstalk/) package.

.footnote[

&ast;Too long; didn't read

]

---
class: center, middle

# Am I talking about a real policy?

Nope, sorry.

All schools selected at random.

---
class: center, middle

# The ask

Visualise school locations to help make a policy decision

--

Quickly

--

Cheaply

--

Shareable

???

area-based programmes operate all the time

---
class: inverse, center, middle

# Solution 1

[`leaflet`](https://rstudio.github.io/leaflet/) interactive map

---
class: center, middle

.image-100[![](img/solution1-1.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/01_leaflet.html)

---

class: center, middle

.image-100[![](img/solution1-2.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/01_leaflet.html)

---
class: center, middle

# Solution 1

.pull-left[

`r icon::fa("check", size = 2)`

interactive

intuitive

]

--

.pull-right[

`r icon::fa("times", size = 2)`

documentation?

rendered in-browser

]

---
class: inverse, center, middle

# Solution 2

[`leaflet`](https://rstudio.github.io/leaflet/) interactive map

in a [`flexdashboard`](https://rmarkdown.rstudio.com/flexdashboard/)

---
class: center, middle

.image-100[![](img/solution2.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/02_leaflet-flexdash.html)

---
class: center, middle

# Solution 2

.pull-left[

`r icon::fa("check", size = 2)`

documentation

self-service

]

--

.pull-right[

`r icon::fa("times", size = 2)`

tabular data?

searchable?

]

---
class: inverse, center, middle

# Solution 3

[`leaflet`](https://rstudio.github.io/leaflet/) interactive map

in a [`flexdashboard`](https://rmarkdown.rstudio.com/flexdashboard/)

with a [`DT`](https://rstudio.github.io/DT/) interactive table


---
class: center, middle

.image-100[![](img/solution3-1.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/03_leaflet-flexdash-dt.html)

---
class: center, middle

.image-100[![](img/solution3-2.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/03_leaflet-flexdash-dt.html)

---
class: center, middle

# Solution 3

.pull-left[

`r icon::fa("check", size = 2)`

tabular data

]

--

.pull-right[

`r icon::fa("times", size = 2)`

download?

widget interactivity?

]

---
class: inverse, center, middle

# What now?

---

# Crosstalk by Joe Cheng

.pull-left[

Crosstalk achieves:

> static HTML documents that <b>do not require Shiny</b> or any kind of server support and yet they can have <b>interactivity between widgets</b>

]

.pull-right[

![Joe Cheng](https://avatars3.githubusercontent.com/u/129551?s=400&v=4)

]

---
class: center, middle

# Model <em>without</em> Crosstalk

.image-100[![](img/model-without.png)]

---
class: center, middle

# Model <em>with</em> Crosstalk

.image-100[![](img/model-with.png)]

---
class: center, middle

# Model <em>with</em> Crosstalk

.image-100[![](img/model-with-filter.png)]

---

# A small code change

#### Before

```{r eval=FALSE}
data <- readRDS("data/some_data.RDS")

datatable(data)

leaflet(data) %>%  addTiles() %>% addMarkers()
```

--

#### After

```{r eval=FALSE}
data <- readRDS("data/some_data.RDS")

shared <- SharedData$new(data)  #<<

datatable(shared)

leaflet(shared) %>% addTiles() %>% addMarkers()
```

---
class: center, middle

# `r icon::fa("exclamation-triangle")` Limitations `r icon::fa("exclamation-triangle")`

1 HTML widgets must be made Crosstalk-compatible

2 Aggregate and summary views not yet available 

3 Crosstalk is not appropriate for large data sets

???

1. There is guidance for the tweak. 
2. Right now only linked brushing and filtering of views that show individual data points, not aggregate or summary views.
3. Depenedent on browser limitations.

---
class: inverse, center, middle

# Okay, Solution 4

[`leaflet`](https://rstudio.github.io/leaflet/) interactive map

in a [`flexdashboard`](https://rmarkdown.rstudio.com/flexdashboard/)

with a [`DT`](https://rstudio.github.io/DT/) interactive table

linked with [`crosstalk`](https://rstudio.github.io/crosstalk/)

---
class: center, middle

.image-100[![](img/solution4-1.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/04_leaflet-flexdash-dt-crosstalk.html)

---
class: center, middle

.image-100[![](img/solution4-2.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/04_leaflet-flexdash-dt-crosstalk.html)

---
class: center, middle

.image-100[![](img/solution4-3.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/04_leaflet-flexdash-dt-crosstalk.html)

---
class: center, middle

.image-100[![](img/solution4-4.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/04_leaflet-flexdash-dt-crosstalk.html)

---
class: center, middle

.image-100[![](img/solution4-5.PNG)]

Demo available [here](https://matt-dray.github.io/earl18-crosstalk/04_leaflet-flexdash-dt-crosstalk.html)

---
class: center, middle

# Solution 4

.pull-left[

`r icon::fa("check", size = 2)`

widgets linked

filtering and brushing

downloads

]

--

.pull-right[

`r icon::fa("times", size = 2)`

More points!

More widgets!

]

---
class: center, middle

# Impact

> the maps have been added to a submission for the minister

<p>
> policy and the external stakeholders have been extremely impressed 

<p>
> due to the positive feedback we are now using the same process for [another policy]

---
class: center, middle

# TL;DR

Need to create a small interactive app without a server or Shiny?

Try the [`crosstalk`](http://rstudio.github.io/crosstalk/) package.

---
class: inverse, center, middle

# Matt Dray

`r icon::fa("envelope")` [matthew.dray@education.gov.uk](mailto:matthew.dray@education.gov.uk)

`r icon::fa("globe")` [rostrum.blog](https://rostrum.blog) | `r icon::fa("twitter")` [twitter.com/mattdray](https://www.twitter.com/mattdray) | `r icon::fa("github")`  [github.com/matt-dray](https://www.github.com/matt-dray)

---

# Resources

.pull-left[

#### This presentation

[Hosted online](https://matt-dray.github.io/earl18-presentation/)

[GitHub repo](https://github.com/matt-dray/earl18-presentation)

#### Demos

Solutions [1](https://matt-dray.github.io/earl18-crosstalk/01_leaflet.html), [2](https://matt-dray.github.io/earl18-crosstalk/02_leaflet-flexdash.html), [3](https://matt-dray.github.io/earl18-crosstalk/03_leaflet-flexdash-dt.html) and [4](https://matt-dray.github.io/earl18-crosstalk/04_leaflet-flexdash-dt-crosstalk.html)

[GitHub repo](https://github.com/matt-dray/earl18-crosstalk)

]

.pull-right[

#### Crosstalk docs

[Site](https://rstudio.github.io/crosstalk/) and [GitHub repo](https://github.com/rstudio/crosstalk)

CRAN [manual](https://cran.r-project.org/web/packages/crosstalk/crosstalk.pdf) and [details](https://CRAN.R-project.org/package=crosstalk)

Talk at [rstudio::conf 2017](https://www.rstudio.com/resources/videos/linking-html-widgets-with-crosstalk/)

#### Examples

[Gapminder example](http://rstudio-pubs-static.s3.amazonaws.com/209203_02f14fea3274448bbbf8d04c99c6051b.html)

Demo [without](https://rpubs.com/jcheng/dash1) and [with](https://rpubs.com/jcheng/dash2) Crosstalk

]